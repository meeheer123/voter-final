<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dropdown Form</title>
</head>
<body>
    <h1>Dropdown Form</h1>
    <form id="myForm">
        <label for="city">Select City:</label>
        <select id="city" name="city">
            <option value="">Select City</option>
            {% for city in cities %}
                <option value="{{ city }}">{{ city }}</option>
            {% endfor %}
        </select>

        <br>

        <label for="region">Select Region:</label>
        <select id="region" name="region" disabled>
            <option value="">Select Region</option>
            <!-- Options will be populated using JavaScript -->
        </select>

        <br>

        <label for="ward">Select Ward:</label>
        <select id="ward" name="ward" disabled>
            <option value="">Select Ward</option>
            <!-- Options will be populated using JavaScript -->
        </select>

        <br>

        <button type="button" onclick="submitForm()">Submit</button>
    </form>

    <script>
        function submitForm() {
            var city = document.getElementById('city').value;
            var region = document.getElementById('region').value;
            var ward = document.getElementById('ward').value;

            var formData = {
                city: city,
                region: region,
                ward: ward
            };

            // Assuming you're using AJAX to send data to the Flask backend
            // You can use libraries like Axios or the native Fetch API

            // Example using Fetch API
            fetch('/submit_form', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
            })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
                // Handle success as needed
            })
            .catch((error) => {
                console.error('Error:', error);
                // Handle errors as needed
            });
        }

        document.addEventListener("DOMContentLoaded", function() {
            var cityDropdown = document.getElementById('city');
            var regionDropdown = document.getElementById('region');
            var wardDropdown = document.getElementById('ward');

            cityDropdown.addEventListener('change', function() {
                // Reset region and ward dropdowns
                regionDropdown.innerHTML = '<option value="">Select Region</option>';
                wardDropdown.innerHTML = '<option value="">Select Ward</option>';
                
                // Fetch regions for the selected city
                fetch('/get_regions/' + cityDropdown.value)
                    .then(response => response.json())
                    .then(data => {
                        // Populate region dropdown
                        data.forEach(function(region) {
                            var optionElement = document.createElement('option');
                            optionElement.value = region;
                            optionElement.text = region;
                            regionDropdown.add(optionElement);
                        });

                        // Enable region dropdown
                        regionDropdown.disabled = false;
                    });
            });

            regionDropdown.addEventListener('change', function() {
                // Reset ward dropdown
                wardDropdown.innerHTML = '<option value="">Select Ward</option>';

                // Fetch wards for the selected region
                fetch('/get_wards/' + regionDropdown.value)
                    .then(response => response.json())
                    .then(data => {
                        // Populate ward dropdown
                        data.forEach(function(ward) {
                            var optionElement = document.createElement('option');
                            optionElement.value = ward;
                            optionElement.text = ward;
                            wardDropdown.add(optionElement);
                        });

                        // Enable ward dropdown
                        wardDropdown.disabled = false;
                    });
            });
        });
    </script>
</body>
</html>
